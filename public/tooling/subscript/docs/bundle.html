
<div exportgroup="README.md">
	<h1 id="an-overview">An Overview</h1>
	<p>Subscript is a reactivity runtime for JavaScript. It takes any valid JavaScript code, reads its dependency graph, and offers a mechanism to run it both in whole and in <em>reactive</em> selections, called <em>dependency threads</em>.</p>
	<h2 id="whats-a-dependency-thread">What's A Dependency Thread?</h2>
	<p>Think of it as the dependency chain involving two or more JavaScript expressions. üëá</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">let</span> count <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> doubleCount <span class="token operator">=</span> count <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span> quadCount <span class="token operator">=</span> doubleCount <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span></code></pre>
	<p>We just expressed that <code>doubleCount</code> should be two times the value of <code>count</code>, and that <code>quadCount</code> should be two times the value of <code>doubleCount</code>; each subsequent expression being a <em>dependent</em> of the previous.</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> count<span class="token punctuation">,</span> doubleCount<span class="token punctuation">,</span> quadCount <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">40</span></code></pre>
	<p>üòâ Can you spot that same dependency chain in the following hypothetical UI render function‚Ä¶?</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">let</span> count <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></code></pre>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">let</span> <span class="token function-variable function">render</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> countElement <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span> <span class="token string">'#count'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    countElement<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> count<span class="token punctuation">;</span>

    <span class="token keyword">let</span> doubleCount <span class="token operator">=</span> count <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> doubleCountElement <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span> <span class="token string">'#double-count'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    doubleCountElement<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> doubleCount<span class="token punctuation">;</span>

    <span class="token keyword">let</span> quadCount <span class="token operator">=</span> doubleCount <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> quadCountElement <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span> <span class="token string">'#quad-count'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    quadCountElement<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> quadCount<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
	<p>You'll also notice one additional <em>dependent</em> at each level of the chain. That brings the <em>dependency thread</em> for <code>count</code> to being the following sequence: <code>statement 2</code> -&gt; <code>statement 3</code> -&gt; <code>statement 5</code> -&gt; <code>statement 6</code> -&gt; <code>statement 8</code>; excluding statements <code>1</code>, <code>4</code>, <code>7</code>.</p>
	<p>ü§ù Good analysis! But what's the deal?</p>
	<p>Programs are generally expected to run <strong>in whole</strong>, <strong>not in dependency threads</strong>! It would take some magic to have the latter. But‚Ä¶ well, that's what's for dinner with Subscript! üòÅ</p>
	<p>Problem is: the mathematical relationship above only holds for as long as nothing changes. Should the value of <code>count</code> change, then its dependents are sure out of sync.</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js">count <span class="token operator">++</span><span class="token punctuation">;</span></code></pre>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> count<span class="token punctuation">,</span> doubleCount<span class="token punctuation">,</span> quadCount <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">40</span></code></pre>
	<p>This is that reminder that expressions in JavaScript aren't automatically bound to their dependencies. (Something we'd expect of any programming language.) The <code>render()</code> function must be called again each time the value of <code>count</code> changes.</p>
	<p>An important worry is that we end up running overheads on sebsequent calls to <code>render()</code>, as those <code>document.querySelector()</code> calls traverse the DOM again, just to return the same elements as in previous runs. (In real life, there could be even more expensive operations up there.)</p>
	<p>Enter dependency threads; suddenly, we can get statements to run in isolation in response to a change! <strong>Here comes a new way to think about reactivity and performance in JavaScript</strong>! üëá</p>
	<p>&gt; Obtain <code>SubscriptFunction</code> and use as a drop-in replacement for <code>Function</code>! üëá</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">let</span> render <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubscriptFunction</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    let countElement = document.querySelector( '#count' );
    countElement.innerHTML = count;

    let doubleCount = count * 2;
    let doubleCountElement = document.querySelector( '#double-count' );
    doubleCountElement.innerHTML = doubleCount;

    let quadCount = doubleCount * 2;
    let quadCountElement = document.querySelector( '#quad-count' );
    quadCountElement.innerHTML = quadCount;</span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
	<blockquote>
	  <p>More about the syntatic rhyme between <code>SubscriptFunction</code> and <code>Function</code> <a href="#api">ahead</a>.</p>
	</blockquote>
	<p>&gt; Use <code>render</code> as a normal function‚Ä¶</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
	<p><em>The above executes the function body in whole as we'd expect. Elements are selected and assigned content. And we can see the counters in the console.</em></p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> count<span class="token punctuation">,</span> doubleCount<span class="token punctuation">,</span> quadCount <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">40</span></code></pre>
	<p>&gt; Run just the <code>count</code> dependency thread‚Ä¶</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js">count <span class="token operator">++</span><span class="token punctuation">;</span>
render<span class="token punctuation">.</span><span class="token function">thread</span><span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token string">'count'</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
	<p>*This time, only statements <code>2</code> -&gt; <code>3</code> -&gt; <code>5</code> -&gt; <code>6</code> -&gt; <code>8</code> are run - *the "count" dependency thread<em>; and the previously selected UI elements in those local variables are only now updated.</em></p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> count<span class="token punctuation">,</span> doubleCount<span class="token punctuation">,</span> quadCount <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">44</span></code></pre>
	<p>&gt; Use <code>SubscriptFunction</code> as a building block.</p>
	<p><em>A Custom Element Example <a href="/tooling/subscript/docs/usage/subscript-element">here</a></em></p>
	<p><em>And here is a live demo of a "count" dependency thread.</em></p>
	<iframe frameborder="0" width="100%" height="500px" src="https://replit.com/@WebQit/Dependency-Thread-Demo-3-Counts-Button?embed=true"></iframe>
	<h2 id="what-is-subscript">What Is Subscript?</h2>
	<p>A general-purpose reactivity runtime for JavaScript, with an overarching philosophy of <em>reactivity that is based on the dependency graph of your own code, and nothing of its own syntax</em>!</p>
	<p>It takes any piece of code and compiles it into an ordinary JavaScript function that can also run expressions in <em>dependency threads</em> via a <code>.thread()</code> method!</p>
	<p>Being function-based let's us have all of Subscript as a building block‚Ä¶ to fit anywhere!</p>
	<h2 id="explore-the-docs">Explore the Docs</h2>
	<p><em>If you have questions about anything related to the Subscript, you're always welcome to ask on our <a href="https://github.com/webqit/subscript/discussions">GitHub Discussions</a>.</em></p>
</div>
<template name="concepts">
    <div exportgroup="README.md">
    	<h1 id="concepts">Concepts</h1>
    </div>
    <template name="conditionals-and-logic">
        <div exportgroup="README.md">
        	<h1 id="conditionals-and-logic">Conditionals And Logic</h1>
        	<p>When the <em>test expression</em> of an "If/Else" statement, "Switch" statement, or other logical expressions contains references, the statement or logical expression is bound to those references. This lets us have <em>reactive conditionals and logic</em>.</p>
        	<h2 id="ifelse-statements">"If/Else" Statements</h2>
        	<p>An "If/Else" statement is bound to references in its "test" expression.</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">if</span> <span class="token punctuation">(</span> score <span class="token operator">&gt;</span> <span class="token number">80</span> <span class="token operator">&amp;&amp;</span> <span class="token function">passesSomeOtherTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">addBadge</span><span class="token punctuation">(</span> candidate <span class="token punctuation">)</span><span class="token punctuation">;</span>
    candidate<span class="token punctuation">.</span>remark <span class="token operator">=</span> <span class="token string">'You\'ve got a badge'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span></code></pre>
        	<p><em>Above, the "If/Else" construct is bound to the references <code>score</code> and <code>passesSomeOtherTest</code> - yes, should that also change. A thread event for any of these gets the construct re-evaluated; first, the "test" expression (<code>score &gt; 80 &amp;&amp; passesSomeOtherTest()</code>), then, the body of the appropriate branch of the construct.</em></p>
        	<p>Statements in the body of the "consequent" and "alternate" branches form a binding to references of their own, independent of their containing "If" construct. But they only respond to thread events for as long as the "state" of all <em>conditions in context</em> allows.</p>
        	<p><em>Above, the <code>addBadge()</code> expression is bound to the reference <code>candidate</code>, and joins alone in the dependency thread, independent of the "If" construct, but for as long as the condition in context (<code>score &gt; 80 &amp;&amp; passesSomeOtherTest()</code>) holds true.</em></p>
        	<blockquote>
        	  <p>The "state" of all <em>conditions in context</em> are determined via <em>memoization</em>, and no re-evaluation ever takes place.</p>
        	</blockquote>
        	<p>An "Else/If" block is taken for just an "If" statement in the "Else" block of a parent "If" statement‚Ä¶</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">if</span> <span class="token punctuation">(</span> score <span class="token operator">&gt;</span> <span class="token number">80</span> <span class="token operator">&amp;&amp;</span> <span class="token function">passesSomeOtherTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">addBadge</span><span class="token punctuation">(</span> candidate <span class="token punctuation">)</span><span class="token punctuation">;</span>
    candidate<span class="token punctuation">.</span>remark <span class="token operator">=</span> <span class="token string">'You\'ve got a badge'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span> someOtherCondition <span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span></code></pre>
        	<p>‚Ä¶and is bound to references in its own "test" expression, independent of its parent. But it only responds to thread events for as long as the "state" of all <em>conditions in context</em> allows.</p>
        	<p><em>Above, the nested "If" statement is bound to the reference <code>someOtherCondition</code>, and joins alone in the dependency thread, independent of the parent "If" construct, but for as long as the parent condition (<code>score &gt; 80 &amp;&amp; passesSomeOtherTest()</code>) holds false.</em></p>
        	<h2 id="switch-statements">"Switch" Statements</h2>
        	<p>A "Switch" statement is bound to references in its "test" expressions - the "switch/case" expressions.</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">switch</span><span class="token punctuation">(</span> score <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>
        candidate<span class="token punctuation">.</span>remark <span class="token operator">=</span> <span class="token string">'You got nothing at all'</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token literal-property property">maxScore</span><span class="token operator">:</span>
        candidate<span class="token punctuation">.</span>remark <span class="token operator">=</span> <span class="token string">'You got the most'</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
        candidate<span class="token punctuation">.</span>remark <span class="token operator">=</span> defaultRemark<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
        	<p><em>Above, the "Switch" construct is bound to the references <code>score</code> and <code>maxScore</code>. A thread event for any of these gets the construct re-evaluated; first, the "switch/case" expressions (<code>score === 0</code> | <code>score === maxScore</code> | <code>score === null</code>), then, the body of the appropriate branch of the construct.</em></p>
        	<p>Statements in the body of the branches form a binding to references of their own, independent of the "Switch" construct. But they only respond to thread events for as long as the "state" of all <em>conditions in context</em> allows.</p>
        	<p><em>Above, the assignment to <code>candidate.remark</code> (in the "default" case) is bound to the reference <code>defaultRemark</code>, and joins alone in the dependency thread, independent of the "Switch" construct, but for as long as the conditions in context (<code>score === null</code>) hold true.</em></p>
        	<blockquote>
        	  <p>The "state" of all <em>conditions in context</em> are determined via <em>memoization</em>, and no re-evaluation ever takes place.</p>
        	</blockquote>
        	<h2 id="logical-and-ternary-expressions">Logical And Ternary Expressions</h2>
        	<p>Subscript observes the state of logical (<code>a &amp;&amp; b || c</code>) and ternary (<code>a ? b : c</code>) expressions when running dependency threads.</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">let</span> <span class="token function-variable function">a</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> d<span class="token punctuation">,</span> e<span class="token punctuation">;</span></code></pre>
        	<p>A logical expression‚Ä¶</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js">e <span class="token operator">=</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> b <span class="token operator">||</span> c<span class="token punctuation">;</span></code></pre>
        	<p>A ternary expression‚Ä¶</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js">d <span class="token operator">=</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> b <span class="token operator">:</span> c<span class="token punctuation">;</span></code></pre>
        	<p><em>Above, each of the two expressions is bound to the references <code>a</code>, <code>b</code> and <code>c</code>. A thread event for any of <code>a</code> and <code>b</code> - or <code>a</code> and <code>c</code>, as determined by the "logical state" of the expressions<sup></sup></em> - gets the expressions re-evaluated; first, the "test" expression (<code>a()</code>), then, the expression on the appropriate side of the construct.*</p>
        	<p><sup>*</sup>Since expressions in the "consequent" and "alternate" sides of a conditional or logical expression are mutually exclusive (<code>b</code> and <code>c</code> above), as determined by the "test" expression (<code>a()</code> above), only the thread events for the references in the currently active side (<code>b</code> above) are honoured by the expression at any given point in time.</p>
        </div>
    </template>
    <template name="functions">
        <div exportgroup="README.md">
        	<h1 id="functions">Functions</h1>
        	<p>Functions are <em>static</em> definitions‚Ä¶</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span> <span class="token parameter">a<span class="token punctuation">,</span> b</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span></code></pre>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">let</span> <span class="token function-variable function">sum</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">a<span class="token punctuation">,</span> b</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span></code></pre>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">let</span> <span class="token function-variable function">sum</span> <span class="token operator">=</span> <span class="token punctuation">(</span> <span class="token parameter">a<span class="token punctuation">,</span> b</span> <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span></code></pre>
        	<p>‚Ä¶and nothing about their parameters is reactive!</p>
        	<p>They are really only significant at <em>call-time</em>; and call-time arguments are rightly <em>reactive</em>!</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span> score<span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
        	<p><em>The expression above is bound to the reference <code>score</code>. A thread event for <code>score</code> gets the <code>sum()</code> function called again with its current value.</em></p>
        	<h2 id="side-effects">Side Effects</h2>
        	<p>When a function modifies anything outside of its scope, it is said to have <em>side effects</em>.</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">let</span> callCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span> <span class="token parameter">a<span class="token punctuation">,</span> b</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    callCount <span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
        	<p>When it does not, it is said to be a <em>pure function</em>.</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span> <span class="token parameter">a<span class="token punctuation">,</span> b</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
        	<p>Regardless, Subscript's dependency threads are fully able to pick up changes made via a side effect. (Side effects made by class methods are currently not being detected.)</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span> <span class="token parameter">a<span class="token punctuation">,</span> b</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    callCount <span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> callCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span> score<span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">'Number of times we\'ve summed:'</span><span class="token punctuation">,</span> callCount <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
        	<p><em>Above, each time the thread event for <code>score</code> gets the <code>sum()</code> expression to run again, <code>callCount</code> is incremented as a side effect; and the dependent <code>console.log()</code> expression joins in the thread to pick that up!</em></p>
        	<p>Since statements in a dependency thread are executed in normal program execution order, side effects only trigger dependent expressions that appear <em>after the point of call</em>, <em>not before</em>.</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span> <span class="token parameter">a<span class="token punctuation">,</span> b</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    callCount <span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> callCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">'BEFORE POINT OF CALL: Number of times we\'ve summed:'</span><span class="token punctuation">,</span> callCount <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span> score<span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">'AFTER POINT OF CALL: Number of times we\'ve summed:'</span><span class="token punctuation">,</span> callCount <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
        	<p><em>Above, on the thread event for <code>score</code>, the first <code>console.log()</code> expression doesn't run because at that point <code>sum()</code> hasn't been called to make the side effect!</em></p>
        	<p>Also, since Subscript does not change runtime expection in any way, side effects made by function calls outside of a running thread do not get to start a thread in a bid to engage its dependent expressions!</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span> <span class="token parameter">a<span class="token punctuation">,</span> b</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    callCount <span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> callCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span> <span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span> score<span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">'Number of times we\'ve summed:'</span><span class="token punctuation">,</span> callCount <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
        	<p><em>This time, <code>sum()</code> is triggerred from a click event handler, not via a dependency thread, and we do not expect the <code>console.log()</code> expression to run!</em></p>
        	<h2 id="subscript-function-syntax-">Subscript Function Syntax (<code>**</code>)</h2>
        	<p>Subscript explores the possibility of defining functions outright as <em>reactive</em> functions using regular <em>Function Declaration</em> and <em>Function Expression</em> syntaxes!</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">function</span><span class="token operator">**</span> <span class="token function">sum</span><span class="token punctuation">(</span> <span class="token parameter">a<span class="token punctuation">,</span> b</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span></code></pre>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">let</span> <span class="token function-variable function">sum</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token operator">**</span><span class="token punctuation">(</span> a<span class="token punctuation">,</span> b <span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span></code></pre>
        	<p><em>Notice the double star <code>**</code> symbol above; it's just one star extra to the standard syntax for <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Generator">Generator Functions</a> (<code>function* gen() {}</code>) - one more thing in the same classification of a special-purpose function in JavaScript! üòé</em></p>
        	<p>Functions defined this way are compiled as <code>SubscriptFunction</code>, exposing a <code>.thread()</code> method for running dependency threads, and offering everything else as in when we use the <code>SubscriptFunction</code> constructor.</p>
        	<p>The following syntaxes produce a reactive function‚Ä¶</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">function</span><span class="token operator">**</span> <span class="token function">sum</span><span class="token punctuation">(</span> <span class="token parameter">a<span class="token punctuation">,</span> b</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">let</span> <span class="token function-variable function">sum</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token operator">**</span><span class="token punctuation">(</span> a<span class="token punctuation">,</span> b <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">let</span> sum <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubscriptFunction</span><span class="token punctuation">(</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">a</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">b</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">return a + b;</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
        	<p>‚Ä¶but the first two (proposed syntaxes) are only currently supported within a Subscript Function itself!</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">let</span> score <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> program <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubscriptFunction</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    function** sum( a, b ) {
        callCount ++;
        return a + b;
    }

    let callCount = 0;

    // The following call results in a side effect
    let result = sum( score, 100 );

    // and "callCount" is logged as "1" to the console 
    console.log( 'Number of times we\'ve summed:', callCount );

    // The following call runs a dependency thread that excludes the side effect
    // while return the sum of the previous values of "a" and "b"
    let result = sum.thread( [ 'a' ] );

    // and "callCount" is still logged as "1", not "2", to the console 
    console.log( 'Number of times we\'ve summed:', callCount );
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">program</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
        	<p>Objects and classes have an equivalent syntax for a Subscript method‚Ä¶</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">let</span> myObject <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">sum</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token operator">**</span><span class="token punctuation">(</span> a<span class="token punctuation">,</span> b <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">let</span> myObject <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token operator">**</span><span class="token function">sum</span><span class="token punctuation">(</span> <span class="token parameter">a<span class="token punctuation">,</span> b</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">class</span> <span class="token class-name">MyClass</span> <span class="token punctuation">{</span>
    <span class="token operator">**</span><span class="token function">sum</span><span class="token punctuation">(</span> <span class="token parameter">a<span class="token punctuation">,</span> b</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
        	<p>‚Ä¶but these (proposed) syntaxes are only currently supported from within Subscript Function itself! (Also, class methods only currently support the double-star syntax at face value; they do not yet compile as Subscript methods.)</p>
        	<p>However, Subscript offers a <em><a href="/tooling/subscript/docs/api#subscriptclass">Class Mixin</a></em> that automatically reredefines class methods as Subscript methods.</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">class</span> <span class="token class-name">MyClass</span> <span class="token keyword">extends</span> <span class="token class-name">SubscriptClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">static</span> <span class="token keyword">get</span> <span class="token function">subscriptMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span> <span class="token string">'sum'</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">sum</span><span class="token punctuation">(</span> <span class="token parameter">a<span class="token punctuation">,</span> b</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">class</span> <span class="token class-name">MyClass</span> <span class="token keyword">extends</span> <span class="token class-name">SubscriptClass</span><span class="token punctuation">(</span> HTMLElement <span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">static</span> <span class="token keyword">get</span> <span class="token function">subscriptMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span> <span class="token string">'render'</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
        </div>
    </template>
    <template name="loops">
        <div exportgroup="README.md">
        	<h1 id="loops">Loops</h1>
        	<p>When the parameters of a loop ("For" loops, "While" and "Do ‚Ä¶ While" loops) contain references, the loop is bound to those references. This lets us have reactive loops.</p>
        	<h2 id="a-for-loop-while-and-do-‚Ä¶-while-loop">A <code>for</code> Loop, <code>while</code> And <code>do ‚Ä¶ while</code> Loop</h2>
        	<p>A "For" loop is bound to references in its 3-part definition.</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">let</span> start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> items <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">,</span> <span class="token string">'three'</span><span class="token punctuation">,</span> <span class="token string">'four'</span><span class="token punctuation">,</span> <span class="token string">'five'</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> targetItems <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">let</span> index <span class="token operator">=</span> start<span class="token punctuation">;</span> index <span class="token operator">&lt;</span> items<span class="token punctuation">.</span>length<span class="token punctuation">;</span> index <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    targetItems<span class="token punctuation">[</span> index <span class="token punctuation">]</span> <span class="token operator">=</span> items<span class="token punctuation">[</span> index <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
        	<p><em>The loop above is bound to the references <code>start</code>, <code>items</code>, and <code>items.length</code>. A thread event for any of these gets the loop to run again.</em></p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token comment">// Say, "start" were a global variable</span>
start <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
fn<span class="token punctuation">.</span><span class="token function">thread</span><span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token string">'start'</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token comment">// Say, "items" were a global variable</span>
items<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span> <span class="token string">'zero'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
fn<span class="token punctuation">.</span><span class="token function">thread</span><span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token string">'items'</span><span class="token punctuation">,</span> <span class="token string">'length'</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
        	<p>As with a "For" loop, a "While" and "Do ‚Ä¶ While" loop are bound to references in their "test" expression.</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> items <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">,</span> <span class="token string">'three'</span><span class="token punctuation">,</span> <span class="token string">'four'</span><span class="token punctuation">,</span> <span class="token string">'five'</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> targetItems <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">while</span> <span class="token punctuation">(</span> index <span class="token operator">&lt;</span> items<span class="token punctuation">.</span>length <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    targetItems<span class="token punctuation">[</span> index <span class="token punctuation">]</span> <span class="token operator">=</span> items<span class="token punctuation">[</span> index <span class="token punctuation">]</span><span class="token punctuation">;</span>
    index <span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
        	<p><em>The loop above is bound to the references <code>items</code> and <code>items.length</code>. A thread event for any of these gets the loop to run again.</em></p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token comment">// Say, items were global variables</span>
items<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span> <span class="token string">'zero'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
fn<span class="token punctuation">.</span><span class="token function">thread</span><span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token string">'items'</span><span class="token punctuation">,</span> <span class="token string">'length'</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
        	<h2 id="a-for-‚Ä¶-of-loop">A <code>for ‚Ä¶ of</code> Loop</h2>
        	<p>A "For ‚Ä¶ Of" loop is bound to references in its <em>iteratee</em>.</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">let</span>  entries <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">,</span> <span class="token string">'three'</span><span class="token punctuation">,</span> <span class="token string">'four'</span><span class="token punctuation">,</span> <span class="token string">'five'</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> targetEntries <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">let</span> entry <span class="token keyword">of</span> entries <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> index <span class="token operator">=</span> entries<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span> entry <span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Current iteration index is: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span> index <span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, and entry is: '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span> entry <span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">'</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    targetEntries<span class="token punctuation">[</span> index <span class="token punctuation">]</span> <span class="token operator">=</span> entries<span class="token punctuation">[</span> index <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
        	<p><em>The loop above is bound to the reference <code>entries</code>. A thread event for <code>entries</code> gets the loop to run again.</em></p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token comment">// Say, entries were a global variable</span>
entries <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token string">'six'</span><span class="token punctuation">,</span> <span class="token string">'seven'</span><span class="token punctuation">,</span> <span class="token string">'eight'</span><span class="token punctuation">,</span> <span class="token string">'nine'</span><span class="token punctuation">,</span> <span class="token string">'ten'</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
fn<span class="token punctuation">.</span><span class="token function">thread</span><span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token string">'entries'</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
        	<p>As an added advantage of this form of loop, updating a specific entry in <code>entries</code> moves the loop's pointer to the specific iteration involving that entry, and the body of that iteration is run again.</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js">entries<span class="token punctuation">[</span> <span class="token number">7</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'This is new eight'</span><span class="token punctuation">;</span>
fn<span class="token punctuation">.</span><span class="token function">thread</span><span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token string">'entries'</span><span class="token punctuation">,</span> <span class="token number">7</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
        	<p>Now, the console reports‚Ä¶</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js">Current iteration index is<span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">,</span> and entry is<span class="token operator">:</span> <span class="token string">'This is new eight'</span></code></pre>
        	<p>‚Ä¶and index <code>7</code> of <code>targetEntries</code> is updated.</p>
        	<h2 id="a-for-‚Ä¶-in-loop">A <code>for ‚Ä¶ in</code> Loop</h2>
        	<p>A "For ‚Ä¶ In" loop is bound to references in its <em>iteratee</em>.</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">let</span>  entries <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">one</span><span class="token operator">:</span> <span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token literal-property property">two</span><span class="token operator">:</span> <span class="token string">'two'</span><span class="token punctuation">,</span> <span class="token literal-property property">three</span><span class="token operator">:</span> <span class="token string">'three'</span><span class="token punctuation">,</span> <span class="token literal-property property">four</span><span class="token operator">:</span> <span class="token string">'four'</span><span class="token punctuation">,</span> <span class="token literal-property property">five</span><span class="token operator">:</span> <span class="token string">'five'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> targetEntries <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">let</span> propertyName <span class="token keyword">in</span> entries <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Current property name is: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span> propertyName <span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, and associated value is: '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span> entries<span class="token punctuation">[</span> propertyName <span class="token punctuation">]</span> <span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">'</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    targetEntries<span class="token punctuation">[</span> propertyName <span class="token punctuation">]</span> <span class="token operator">=</span> entries<span class="token punctuation">[</span> propertyName <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
        	<p><em>The loop above is bound to the reference <code>entries</code>. A thread event for <code>entries</code> gets the loop to run again.</em></p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token comment">// Say, entries were a global variable</span>
entries <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">six</span><span class="token operator">:</span> <span class="token string">'six'</span><span class="token punctuation">,</span> <span class="token literal-property property">seven</span><span class="token operator">:</span> <span class="token string">'seven'</span><span class="token punctuation">,</span> <span class="token literal-property property">eight</span><span class="token operator">:</span> <span class="token string">'eight'</span><span class="token punctuation">,</span> <span class="token literal-property property">nine</span><span class="token operator">:</span> <span class="token string">'nine'</span><span class="token punctuation">,</span> <span class="token literal-property property">ten</span><span class="token operator">:</span> <span class="token string">'ten'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
fn<span class="token punctuation">.</span><span class="token function">thread</span><span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token string">'entries'</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
        	<p>As an added advantage of this form of loop, updating a specific property in <code>entries</code> moves the loop's pointer to the specific iteration involving that property, and the body of that iteration is run again.</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js">entries<span class="token punctuation">[</span> <span class="token string">'eight'</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'This is new eight'</span><span class="token punctuation">;</span>
fn<span class="token punctuation">.</span><span class="token function">thread</span><span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token string">'entries'</span><span class="token punctuation">,</span> <span class="token string">'eight'</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
        	<p>Now, the console reports‚Ä¶</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js">Current property name is<span class="token operator">:</span> eight<span class="token punctuation">,</span> and property value is<span class="token operator">:</span> <span class="token string">'This is new eight'</span></code></pre>
        	<p>‚Ä¶and the property <code>eight</code> of <code>targetEntries</code> is updated.</p>
        	<h2 id="iteration-states">Iteration States</h2>
        	<p>Conceptually, each round of iteration in a loop is an instance that Subscript can access directly when running a thread. A round of iteration is thus updatable in isolation, in response to a directed event. This is what happens when the <em>iteratee</em> of a "For ‚Ä¶ Of" and "For ‚Ä¶ In" loop has any of its properties updated, as seen above.</p>
        	<p>Below is a similar case.</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">let</span>  entries <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">one</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'one'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token literal-property property">two</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'two'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> targetEntries <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">let</span> propertyName <span class="token keyword">in</span> entries <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Current property name is: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span> propertyName <span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, and its alias name is: '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span> entries<span class="token punctuation">[</span> propertyName <span class="token punctuation">]</span><span class="token punctuation">.</span>name <span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">'</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    targetEntries<span class="token punctuation">[</span> propertyName <span class="token punctuation">]</span> <span class="token operator">=</span> entries<span class="token punctuation">[</span> propertyName <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
        	<p>On updating the first entry, only the first round of iteration is executed again.</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js">entries<span class="token punctuation">[</span> <span class="token string">'one'</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'New one'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
fn<span class="token punctuation">.</span><span class="token function">thread</span><span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token string">'entries'</span><span class="token punctuation">,</span> <span class="token string">'one'</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
        	<p>For even more granularity, individual expressions inside a round of iteration are also responsive to thread events of their own. So, if we updated just <code>entries.one.name</code>‚Ä¶</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js">entries<span class="token punctuation">.</span>one<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'New one'</span><span class="token punctuation">;</span>
fn<span class="token punctuation">.</span><span class="token function">thread</span><span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token string">'entries'</span><span class="token punctuation">,</span> <span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'name'</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
        	<p>‚Ä¶we would have skipped the iteration instance itself, to target just the first statement within it.</p>
        	<p>This granular reactivity makes it often pointless to trigger a full rerun of a loop, offering multiple opportunities to deliver unmatched performance.</p>
        	<h2 id="breakouts">Breakouts</h2>
        	<p>Subscript observes <code>break</code> and <code>continue</code> statements even when running a thread. And any of these statements may employ <em>labels</em>.</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">let</span>  entries <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">one</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'one'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token literal-property property">two</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'two'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token literal-property property">parentLoop</span><span class="token operator">:</span> <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">let</span> propertyName <span class="token keyword">in</span> entries <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">childLoop</span><span class="token operator">:</span> <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">let</span> subPropertyName <span class="token keyword">in</span> entries<span class="token punctuation">[</span> propertyName <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">If</span> <span class="token punctuation">(</span> propertyName <span class="token operator">===</span> <span class="token string">'one'</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">break</span> parentLoop<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> propertyName<span class="token punctuation">,</span> subPropertyName <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
        </div>
    </template>
    <template name="references-and-bindings">
        <div exportgroup="README.md">
        	<h1 id="references-and-bindings">References And Bindings</h1>
        	<p>Expressions and statements in Subscript maintain a binding to their references. And that's the basis for reactivity in Subscript.</p>
        	<p>For example, variable declarations, with <code>let</code> and <code>var</code>, and assignment expressions, are bound to any references that may be in their argument. (<code>const</code> declarations are an exception as they're always <em>const</em> in nature.)</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">var</span> tense <span class="token operator">=</span> score <span class="token operator">&gt;</span> <span class="token number">50</span> <span class="token operator">?</span> <span class="token string">'passed'</span> <span class="token operator">:</span> <span class="token string">'failed'</span><span class="token punctuation">;</span></code></pre>
        	<p><em>Above, the assignment expression is bound to the reference <code>score</code>; and thus responds to a thread event for <code>score</code>.</em></p>
        	<p>The thread continues with any susequent bindings to the <code>tense</code> variable itself‚Ä¶</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">let</span> message <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hi </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span> candidate<span class="token punctuation">.</span>firstName <span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, you </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span> tense <span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> this test!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span></code></pre>
        	<p><em>Above, the assignment expression is bound to the references <code>candidate</code>, <code>candidate.firstName</code>, and <code>tense</code>; and thus responds to a thread event for each.</em></p>
        	<p>And the thread continues with any susequent bindings to the <code>message</code> variable itself‚Ä¶ and any bindings of those bindings‚Ä¶</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">let</span> fullMessage <span class="token operator">=</span> <span class="token punctuation">[</span> message<span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">'Thank you!'</span> <span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span> <span class="token string">''</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">let</span> broadcast <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span> candidate<span class="token punctuation">.</span>username <span class="token punctuation">]</span><span class="token operator">:</span> fullMessage <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> broadcast <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">let</span> broadcastInstance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BroadcastMessage</span><span class="token punctuation">(</span> broadcast <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
        	<p>And ES6 syntax niceties can come in anywhere.</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">let</span> <span class="token punctuation">{</span> username<span class="token punctuation">,</span> <span class="token literal-property property">profile</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">avatar</span><span class="token operator">:</span> avatarUrl <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token operator">=</span> candidate<span class="token punctuation">;</span></code></pre>
        	<p><em>And that's essentially two variables declared up there: <code>username</code> and <code>avatarUrl</code>! And while <code>username</code> is bound to <code>candidate.username</code>, <code>avatarUrl</code> is bound to <code>candidate.profile.avatar</code>. Each gets updated independent of the other; in sync with their own binding. (But a thread event for their common root object - <code>candidate</code> - gets both variables updated.)</em></p>
        </div>
    </template>
    <template name="thread-events">
        <div exportgroup="README.md">
        	<h1 id="thread-events">Thread Events</h1>
        	<p>Subscript is not concerned with how changes happen or are detected on the outer scope of the function. It simply gives us a way to announce that something has changed. That announcement is called a <em>thread event</em>.</p>
        	<p>A Subscript function has a <code>thread()</code> method that lets us trigger a thread for the list of outside variables or properties that have changed.</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token string">'Apple'</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token string">'Banana'</span><span class="token punctuation">,</span> c <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">prop</span><span class="token operator">:</span> <span class="token string">'Fruits'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">let</span> fn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubscriptFunction</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    console.log( \`The value of 'a' is: \${ a }\` );
    console.log( \`The value of 'b' is: \${ b }\` );
    console.log( \`The value of 'c.prop' is: \${ c.prop }\` );
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token comment">// Initial run</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token comment">// Updates and threads</span>
b <span class="token operator">=</span> <span class="token string">'Breadfruit'</span><span class="token punctuation">;</span>
fn<span class="token punctuation">.</span><span class="token function">thread</span><span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token string">'b'</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
        	<p>The array syntax allows us to represent properties as paths.</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js">fn<span class="token punctuation">.</span><span class="token function">thread</span><span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'prop'</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
        	<p>And we can run one thread for multiple changes.</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js">fn<span class="token punctuation">.</span><span class="token function">thread</span><span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token string">'a'</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span> <span class="token string">'b'</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
        	<p>Variable declarations within the function belong in their own scope and do not respond to outside events. But their containing expression may also maintain a binding to those variables from the outside scope.</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">let</span> fn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubscriptFunction</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    let a = 'Apple', b = 'Banana' + ' ' + c.prop;
    console.log( \`The value of 'a' is: \${ a }\` );
    console.log( \`The value of 'b' is: \${ b }\` );
    console.log( \`The value of 'c.prop' is: \${ c.prop }\` );
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token comment">// Initial run</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token comment">// The following events will have no effect since "a" and "b" are local variables.</span>
fn<span class="token punctuation">.</span><span class="token function">thread</span><span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token string">'a'</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span> <span class="token string">'b'</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token comment">// The local variable "b" will be part of the dependency thread of "c.prop"</span>
<span class="token comment">// (The console will therefore show the result of the last two statements in the function)</span>
fn<span class="token punctuation">.</span><span class="token function">thread</span><span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'prop'</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
        </div>
    </template>
</template>
<template name="spec">
    <div exportgroup="README.md">
    	<h1 id="spec">SPEC</h1>
    </div>
    <template name="api">
        <div exportgroup="README.md">
        	<h1 id="api">API</h1>
        	<h2 id="subscriptfunction">SubscriptFunction</h2>
        	<p><code>SubscriptFunction</code> is a one-to-one equivalent of the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/Function">JavaScript Function constructor</a>. They work interchangeably üòé.</p>
        	<h3 id="syntax">Syntax</h3>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token comment">// Statically</span>
<span class="token keyword">let</span> subscrFunction <span class="token operator">=</span> <span class="token function">SubscriptFunction</span><span class="token punctuation">(</span> functionBody <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> subscrFunction <span class="token operator">=</span> <span class="token function">SubscriptFunction</span><span class="token punctuation">(</span> arg1<span class="token punctuation">,</span> functionBody <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> subscrFunction <span class="token operator">=</span> <span class="token function">SubscriptFunction</span><span class="token punctuation">(</span> arg1<span class="token punctuation">,</span> <span class="token operator">...</span> argN<span class="token punctuation">,</span> functionBody <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// With the new operator</span>
<span class="token keyword">let</span> subscrFunction <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubscriptFunction</span><span class="token punctuation">(</span> functionBody <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> subscrFunction <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubscriptFunction</span><span class="token punctuation">(</span> arg1<span class="token punctuation">,</span> functionBody <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> subscrFunction <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubscriptFunction</span><span class="token punctuation">(</span> arg1<span class="token punctuation">,</span> <span class="token operator">...</span> argN<span class="token punctuation">,</span> functionBody <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
        	<h3 id="parameters">Parameters</h3>
        	<h4 id="arg1--argn"><code>arg1, ... argN</code></h4>
        	<p>Names to be used by the function as formal argument names. Each must be a string that corresponds to a valid JavaScript parameter (any of plain identifier, rest parameter, or destructured parameter, optionally with a default), or a list of such strings separated with commas.</p>
        	<h4 id="functionbody"><code>functionBody</code></h4>
        	<p>A string that represents the function body.</p>
        	<h3 id="return-value">Return Value</h3>
        	<p>A regular <code>Function</code> object, or an <code>async function</code> object where the <code>await</code> keyword is used within <code>functionBody</code>.</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token comment">// Create a regular function - sum</span>
<span class="token keyword">let</span> sum <span class="token operator">=</span> <span class="token function">SubscriptFunction</span><span class="token punctuation">(</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'return a + b;'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Call the returned sum function and log the result</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token function">sum</span><span class="token punctuation">(</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span> <span class="token number">12</span></code></pre>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token comment">// Create an async function - sum</span>
<span class="token keyword">let</span> sum <span class="token operator">=</span> <span class="token function">SubscriptFunction</span><span class="token punctuation">(</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'return a + await b;'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Call the returned sum function and log the result</span>
<span class="token function">sum</span><span class="token punctuation">(</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token parameter">result</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> result <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span> <span class="token number">12</span></code></pre>
        	<h3 id="the-this-binding">The <code>this</code> Binding</h3>
        	<p>Functions returned by <code>SubscriptFunction</code> are standard functions that can have their own <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/this"><code>this</code></a> binding at <em>call time</em>.</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token comment">// Create a function - colorSwitch - that sets a DOM element's color</span>
<span class="token keyword">let</span> colorSwitch <span class="token operator">=</span> <span class="token function">SubscriptFunction</span><span class="token punctuation">(</span> <span class="token string">'color'</span><span class="token punctuation">,</span> <span class="token string">'this.style.color = color;'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Call colorSwitch, with document.body as it's this binding</span>
<span class="token keyword">let</span> element <span class="token operator">=</span> document<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
<span class="token function">colorSwitch</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span> element<span class="token punctuation">,</span> <span class="token string">'red'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
        	<p>But, where the <code>this</code> binding is <code>undefined</code> at call time, the <code>this</code> binding of the <code>SubscriptFunction</code> itself is used. This lets us have a default <code>this</code> binding at <em>creation time</em>.</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token comment">// Create the same colorSwitch, this time, with a this binding that can be used at call time</span>
<span class="token keyword">let</span> element <span class="token operator">=</span> document<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
<span class="token keyword">let</span> colorSwitch <span class="token operator">=</span> <span class="token function">SubscriptFunction</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span> element<span class="token punctuation">,</span> <span class="token string">'color'</span><span class="token punctuation">,</span> <span class="token string">'this.style.color = color;'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Call colorSwitch, without a this binding</span>
<span class="token function">colorSwitch</span><span class="token punctuation">(</span> <span class="token string">'red'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">colorSwitch</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token string">'red'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Call colorSwitch, with a different this binding</span>
<span class="token keyword">let</span> h1Element <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span> <span class="token string">'h1'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">colorSwitch</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span> h1Element<span class="token punctuation">,</span> <span class="token string">'red'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
        	<h3 id="the-subscrfunctionthread-method">The <code>subscrFunction.thread()</code> Method</h3>
        	<p>The <code>.thread()</code> method is the <em>reactivity</em> API in Subscript functions that lets us send <em>thread events</em> into the <em>reactivity runtime</em>. It constitues one clear interaction point and enables a one-liner approach to reactivity.</p>
        	<p>It takes a list of the outside variables or properties that have changed; each as an array path.</p>
        	<h5 id="syntax-1">Syntax</h5>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">let</span> returnValue <span class="token operator">=</span> subscrFunction<span class="token punctuation">.</span><span class="token function">thread</span><span class="token punctuation">(</span> path1<span class="token punctuation">,</span> <span class="token operator">...</span> pathN <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
        	<h5 id="parameters-1">Parameters</h5>
        	<h5 id="path1--pathn"><code>path1, ... pathN</code></h5>
        	<p>An array path representing each variable, or object property, that has changed. <em>See <a href="/tooling/subscript/docs/concepts/thread-events">Thread Events</a> for concepts and usage.</em></p>
        	<h4 id="return-value-1">Return Value</h4>
        	<p>The return value of this method depends on the return value of the <em>dependency thread</em> it initiates within the function body.</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token comment">// Global variables to use</span>
a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>

<span class="token comment">// Create a function with two possible values</span>
<span class="token keyword">let</span> sum <span class="token operator">=</span> <span class="token function">SubscriptFunction</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    if ( a &gt; 10 ) {
        return a + await b;
    }
    return a + b;
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Run normally</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span> <span class="token number">12</span>

<span class="token comment">// Run a thread with a different return value</span>
a <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> sum<span class="token punctuation">.</span><span class="token function">thread</span><span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token string">'a'</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span> Promise <span class="token punctuation">{</span> <span class="token number">22</span> <span class="token punctuation">}</span></code></pre>
        	<h2 id="subscriptclass">SubscriptClass</h2>
        	<p><code>SubscriptClass</code> is a <em>convenience</em> base class <em>Mixin</em> that automatically transforms regular class methods as Subscript methods.</p>
        	<h3 id="syntax-2">Syntax</h3>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token keyword">class</span> <span class="token class-name">MyClass</span> <span class="token keyword">extends</span> <span class="token class-name">SubscriptClass</span><span class="token punctuation">(</span> <span class="token punctuation">[</span> BaseClass <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">static</span> <span class="token keyword">get</span> <span class="token function">subscriptMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span> methodName<span class="token punctuation">,</span> <span class="token operator">...</span> methodNameN <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">method</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
        	<h3 id="parameters-2">Parameters</h3>
        	<h4 id="baseclass"><code>BaseClass</code></h4>
        	<p>An optional base class that should be extended.</p>
        	<h4 id="methodname--methodnamen"><code>methodName, ... methodNameN</code></h4>
        	<p>Names of the methods that should be transformed to Subscript methods.</p>
        	<h3 id="return-value-2">Return Value</h3>
        	<p>A <em>class</em> object.</p>
        	<p><em>See <a href="/tooling/subscript/docs/usage/subscript-element">here</a> for usage examples</em></p>
        </div>
    </template>
    <template name="download">
        <div exportgroup="README.md">
        	<h1 id="download-options">Download Options</h1>
        	<p>Subscript can be used either from a CDN or as an npm package.</p>
        	<h2 id="option-1-from-a-cdn">Option 1: From a CDN</h2>
        	<p>Add the following script tag to your page to include the all-in-one Subscript module:</p>
<pre class="line-numbers match-braces language-html" tabindex="0"><code class="html language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://unpkg.com/@webqit/subscript/dist/main.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span></code></pre>
        	<p>The above tag loads Subscript into a global "WebQit" object.</p>
<pre class="line-numbers match-braces language-html" tabindex="0"><code class="html language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">const</span> <span class="token punctuation">{</span> SubscriptFunction<span class="token punctuation">,</span> SubscriptClass <span class="token punctuation">}</span> <span class="token operator">=</span> window<span class="token punctuation">.</span>WebQit<span class="token punctuation">.</span>Subscript<span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span></code></pre>
        	<h2 id="option-2-as-an-npm-package">Option 2: As an npm Package</h2>
        	<p>With <a href="https://docs.npmjs.com/downloading-and-installing-node-js-and-npm">npm available on your terminal</a>, run the following command to install Subscript:</p>
<pre class="line-numbers match-braces language-text" tabindex="0"><code class="text language-text">$ npm i @webqit/subscript</code></pre>
        	<p>Import the installed package:</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token comment">// Import the initializer</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> SubscriptFunction<span class="token punctuation">,</span> SubscriptClass <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@webqit/subscript'</span><span class="token punctuation">;</span></code></pre>
        </div>
    </template>
</template>
<template name="usage">
    <div exportgroup="README.md">
    	<h1 id="usage">Usage</h1>
    </div>
    <template name="subscript-element">
        <div exportgroup="README.md">
        	<h1 id="subscript-element">Subscript Element</h1>
        	<h2 id="a-custom-element-example">A Custom Element Example</h2>
        	<p>As trivial as our hypothetical <a href="#whats-a-dependency-thread"><code>render()</code></a> function above is, we can see it applicable in real life places! Consider a neat reactive <em>Custom Element</em> example based on <a href="/tooling/subscript/docs/api/#subscriptclass"><code>SubscriptClass</code></a>.</p>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token comment">// We'll still keep count as a global variable for now</span>
<span class="token keyword">let</span> count <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></code></pre>
<pre class="line-numbers match-braces language-js" tabindex="0"><code class="js language-js"><span class="token comment">// This custom element extends Subscript as a base class‚Ä¶ more on this later</span>
customElements<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span> <span class="token string">'click-counter'</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> <span class="token function">SubscriptClass</span><span class="token punctuation">(</span> <span class="token parameter">HTMLElement</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token comment">// This is how we designate methods as reactive methods</span>
    <span class="token keyword">static</span> <span class="token keyword">get</span> <span class="token function">subscriptMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span> <span class="token string">'render'</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">connectedCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Full execution at connected time</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Granularly-selective execution at click time</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span> <span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            count <span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>render<span class="token punctuation">.</span><span class="token function">thread</span><span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token string">'count'</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> countElement <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span> <span class="token string">'#count'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        countElement<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> count<span class="token punctuation">;</span>

        <span class="token keyword">let</span> doubleCount <span class="token operator">=</span> count <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> doubleCountElement <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span> <span class="token string">'#double-count'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        doubleCountElement<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> doubleCount<span class="token punctuation">;</span>

        <span class="token keyword">let</span> quadCount <span class="token operator">=</span> doubleCount <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> quadCountElement <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span> <span class="token string">'#quad-count'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        quadCountElement<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> quadCount<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
        	<p><em>See also <a href="https://webqit.io/tooling/oohtml/docs/spec/subscript#subscript-element-mixin">SubscriptElement</a> - the <a href="https://webqit.io/tooling/oohtml">OOHTML</a> extension of <a href="#subscriptclass"><code>SubscriptClass</code></a></em></p>
        </div>
    </template>
</template>